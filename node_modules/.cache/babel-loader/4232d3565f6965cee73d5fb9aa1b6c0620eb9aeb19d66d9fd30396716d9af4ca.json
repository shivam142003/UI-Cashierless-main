{"ast":null,"code":"/**\n * Thrown when no transaction signature can be found referencing a given public key.\n */\nexport class FindReferenceError extends Error {\n  constructor() {\n    super(...arguments);\n    this.name = 'FindReferenceError';\n  }\n}\n/**\n * Find the oldest transaction signature referencing a given public key.\n *\n * @param connection - A connection to the cluster.\n * @param reference - `reference` in the [Solana Pay spec](https://github.com/solana-labs/solana-pay/blob/master/SPEC.md#reference).\n * @param options - Options for `getSignaturesForAddress`.\n *\n * @throws {FindReferenceError}\n */\nexport async function findReference(connection, reference) {\n  let {\n    finality,\n    ...options\n  } = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  const signatures = await connection.getSignaturesForAddress(reference, options, finality);\n  const length = signatures.length;\n  if (!length) throw new FindReferenceError('not found');\n  // If one or more transaction signatures are found under the limit, return the oldest one.\n  const oldest = signatures[length - 1];\n  if (length < (options?.limit || 1000)) return oldest;\n  try {\n    // In the unlikely event that signatures up to the limit are found, recursively find the oldest one.\n    return await findReference(connection, reference, {\n      finality,\n      ...options,\n      before: oldest.signature\n    });\n  } catch (error) {\n    // If the signatures found were exactly at the limit, there won't be more to find, so return the oldest one.\n    if (error instanceof FindReferenceError) return oldest;\n    throw error;\n  }\n}","map":{"version":3,"names":["FindReferenceError","Error","constructor","name","findReference","connection","reference","finality","options","arguments","length","undefined","signatures","getSignaturesForAddress","oldest","limit","before","signature","error"],"sources":["C:\\Users\\Shivam\\OneDrive\\Desktop\\UI-Cashierless-main\\UI-Cashierless-main\\node_modules\\@solana\\pay\\src\\findReference.ts"],"sourcesContent":["import type { ConfirmedSignatureInfo, Connection, Finality, SignaturesForAddressOptions } from '@solana/web3.js';\nimport type { Reference } from './types.js';\n\n/**\n * Thrown when no transaction signature can be found referencing a given public key.\n */\nexport class FindReferenceError extends Error {\n    name = 'FindReferenceError';\n}\n\n/**\n * Find the oldest transaction signature referencing a given public key.\n *\n * @param connection - A connection to the cluster.\n * @param reference - `reference` in the [Solana Pay spec](https://github.com/solana-labs/solana-pay/blob/master/SPEC.md#reference).\n * @param options - Options for `getSignaturesForAddress`.\n *\n * @throws {FindReferenceError}\n */\nexport async function findReference(\n    connection: Connection,\n    reference: Reference,\n    { finality, ...options }: SignaturesForAddressOptions & { finality?: Finality } = {}\n): Promise<ConfirmedSignatureInfo> {\n    const signatures = await connection.getSignaturesForAddress(reference, options, finality);\n\n    const length = signatures.length;\n    if (!length) throw new FindReferenceError('not found');\n\n    // If one or more transaction signatures are found under the limit, return the oldest one.\n    const oldest = signatures[length - 1];\n    if (length < (options?.limit || 1000)) return oldest;\n\n    try {\n        // In the unlikely event that signatures up to the limit are found, recursively find the oldest one.\n        return await findReference(connection, reference, { finality, ...options, before: oldest.signature });\n    } catch (error: any) {\n        // If the signatures found were exactly at the limit, there won't be more to find, so return the oldest one.\n        if (error instanceof FindReferenceError) return oldest;\n        throw error;\n    }\n}\n"],"mappings":"AAGA;;;AAGA,OAAM,MAAOA,kBAAmB,SAAQC,KAAK;EAA7CC,YAAA;;IACI,KAAAC,IAAI,GAAG,oBAAoB;EAC/B;;AAEA;;;;;;;;;AASA,OAAO,eAAeC,aAAaA,CAC/BC,UAAsB,EACtBC,SAAoB,EACgE;EAAA,IAApF;IAAEC,QAAQ;IAAE,GAAGC;EAAO,IAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAA4D,EAAE;EAEpF,MAAMG,UAAU,GAAG,MAAMP,UAAU,CAACQ,uBAAuB,CAACP,SAAS,EAAEE,OAAO,EAAED,QAAQ,CAAC;EAEzF,MAAMG,MAAM,GAAGE,UAAU,CAACF,MAAM;EAChC,IAAI,CAACA,MAAM,EAAE,MAAM,IAAIV,kBAAkB,CAAC,WAAW,CAAC;EAEtD;EACA,MAAMc,MAAM,GAAGF,UAAU,CAACF,MAAM,GAAG,CAAC,CAAC;EACrC,IAAIA,MAAM,IAAIF,OAAO,EAAEO,KAAK,IAAI,IAAI,CAAC,EAAE,OAAOD,MAAM;EAEpD,IAAI;IACA;IACA,OAAO,MAAMV,aAAa,CAACC,UAAU,EAAEC,SAAS,EAAE;MAAEC,QAAQ;MAAE,GAAGC,OAAO;MAAEQ,MAAM,EAAEF,MAAM,CAACG;IAAS,CAAE,CAAC;GACxG,CAAC,OAAOC,KAAU,EAAE;IACjB;IACA,IAAIA,KAAK,YAAYlB,kBAAkB,EAAE,OAAOc,MAAM;IACtD,MAAMI,KAAK;;AAEnB"},"metadata":{},"sourceType":"module","externalDependencies":[]}